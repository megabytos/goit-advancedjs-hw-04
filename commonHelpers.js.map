{"version":3,"file":"commonHelpers.js","sources":["../src/js/refs.js","../src/js/api.js","../src/js/markups.js","../src/js/handlers.js","../src/js/main.js"],"sourcesContent":["const refs = {\n  form: document.querySelector('.search-form'),\n  gallery: document.querySelector('.gallery'),\n  loader: document.querySelector('.loader'),\n  more: document.querySelector('.load-more'),\n  guard: document.querySelector('.js-guard'),\n};\n\nexport default refs;","import axios from 'axios';\naxios.defaults.baseURL = 'https://pixabay.com/api/';\nconst API_KEY = '44676438-8f15550b2268961ea3e6a8228';\n\nexport const fetchImages = async (query, page = 1, per_page) => {\n  if (query) {\n    const { data } = await axios({\n      method: 'GET',\n      params: {\n        key: API_KEY,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        q: query,\n        per_page,\n        page,\n      },\n    });\n    return data;\n  }\n};\n","export const createMarkup = items => {\n  return items\n    .map(\n      ({ largeImageURL, webformatURL, tags, likes, views, comments, downloads }) => `      \n        <a href=\"${largeImageURL}\" class=\"item\">\n        <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n        <div class=\"info\">\n            <p class=\"info-item\"><b>Likes</b>${likes}</p>\n            <p class=\"info-item\"><b>Views</b>${views}</p>\n            <p class=\"info-item\"><b>Comments</b>${comments}</p>\n            <p class=\"info-item\"><b>Downloads</b>${downloads}</p>\n        </div>\n        </a>`\n    )\n    .join('');\n}\n","import refs from './refs';\nimport { fetchImages } from './api';\nimport { createMarkup } from './markups';\nimport SimpleLightbox from 'simplelightbox';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst showElement = elm => elm.classList.remove('visually-hidden');\nconst hideElement = elm => elm.classList.add('visually-hidden');\nlet currentQuery = '';\nlet currentPage = 1;\nlet perPage = 40;\n\nconst lightBox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nexport const handlerFormSubmit = async event => {\n  event.preventDefault();\n\n  refs.gallery.innerHTML = '';\n  hideElement(refs.more);\n  showElement(refs.loader);\n\n  const query = event.target.elements.searchQuery.value.trim().toLowerCase();\n  if (query === '') {\n    iziToast.error({ title: 'Error', message: 'Please enter a search query' });\n    hideElement(refs.loader);\n    return;\n  }\n\n  currentQuery = query;\n  currentPage = 1;\n\n  try {\n    const { totalHits, hits } = await fetchImages(currentQuery, currentPage, perPage);\n    if (totalHits) iziToast.info({ message: `Hooray! We found ${totalHits} images` });\n    updateGallery(hits, totalHits);\n  } catch (error) {\n    iziToast.error({ title: 'Error', message: error.message });\n  } finally {\n    hideElement(refs.loader);\n  }\n};\n\nexport const handlerLoadMore = async () => {\n  currentPage += 1;\n  showElement(refs.loader);\n  try {\n    const { totalHits, hits } = await fetchImages(currentQuery, currentPage, perPage);\n    updateGallery(hits, totalHits);\n  } catch (error) {\n    iziToast.error({ title: 'Error', message: error.message });\n  } finally {\n    hideElement(refs.loader);\n  }\n};\n\nfunction updateGallery(hits, totalHits) {\n  hideElement(refs.more);\n  if (hits.length === 0) {\n    iziToast.info({ message: 'Sorry, there are no images matching your search query. Please try again.' });\n    return;\n  }\n  refs.gallery.insertAdjacentHTML('beforeend', createMarkup(hits));\n  lightBox.refresh();\n  if (currentPage * perPage >= totalHits) {\n    if (currentPage > 1) {\n      iziToast.info({ message: \"We're sorry, but you've reached the end of search results\" });\n    }\n  } else {\n    showElement(refs.more);\n  }\n}\n","import refs from './refs';\nimport { handlerFormSubmit, handlerLoadMore } from './handlers';\n\nrefs.form.addEventListener('submit', handlerFormSubmit);\nrefs.more.addEventListener('click', handlerLoadMore);\n"],"names":["refs","axios","API_KEY","fetchImages","query","page","per_page","data","createMarkup","items","largeImageURL","webformatURL","tags","likes","views","comments","downloads","showElement","elm","hideElement","currentQuery","currentPage","perPage","lightBox","SimpleLightbox","handlerFormSubmit","event","iziToast","totalHits","hits","updateGallery","error","handlerLoadMore"],"mappings":"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"}